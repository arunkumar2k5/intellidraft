WCCA Automation — Desktop App (Tkinter)

Overview

A Windows desktop app to assist WCCA workflows.
Lets you browse/select:
Netlist (.xml)
BOM (.csv)
Conditions (.yaml)
Extracts part numbers from the BOM, queries the DigiKey API, and renders categorized tables (CAP/RES) from the results.
Uses Google’s Generative AI to infer a circuit name from detected ICs and displays it on demand.
Project Structure

Interface.py
Tkinter GUI application and main entry point.
File selection, previews, progress UI, circuit name button.
CSV parsing to collect part numbers and identify ICs.
Triggers DigiKey lookup and renders results from parts.json.
digikey.py
Calls DigiKey OAuth2 for an access token and performs keyword search.
Collects product parameters and writes parts.json in the project folder.
json_table.py
Renders JSON data into Tkinter Treeviews.
Provides categorized CAP and RES tabs and a generic JSON table renderer.
gen_ai.py
Calls Google’s Generative AI (Gemini 2.0 Flash) to infer the circuit name from a list of ICs.
parts.json
Generated file containing DigiKey search results (created/overwritten by digikey.py).
samplelogo.png
Optional app icon, if present.
Requirements

OS: Windows
Python: 3.9+ recommended (tkinter included in the standard Windows Python installer)
Internet access required for:
DigiKey OAuth2 and product search
Google Generative AI
Python Libraries to Install

requests
pandas
google-genai : pip install google-genai

Note:

tkinter and ttk come with the standard Python installer on Windows; no pip install is needed for them.
API Keys and Configuration

DigiKey API:
digikey.py contains hardcoded demo client_id and client_secret.
You must replace these with your own credentials from your DigiKey developer account.
File: digikey.py
client_id = "YOUR_CLIENT_ID"
client_secret = "YOUR_CLIENT_SECRET"
Google Generative AI:
gen_ai.py currently hardcodes an API key.
For security, replace this with an environment variable and update the code, or at minimum replace the hardcoded key with your own.
File: gen_ai.py
from google import genai
client = genai.Client(api_key="YOUR_API_KEY")
Running the App

Activate your virtual environment:
.venv\Scripts\activate
From the project folder, run:
python Interface.py
The app window opens maximized (WCCA Automation).
Click “Browse” under each column to select files:
Netlist: .xml
Bom: .csv
Conditions: .yaml
CSV behavior:
The app automatically detects delimiter and header.
It extracts part numbers from the first column (column index 0).
It also reads the next column to detect reference designators and identifies likely ICs (designators containing “U”) for the circuit name prompt.
What Happens After Selecting the BOM

The app extracts unique part numbers and calls DigiKey to fetch product details.
A circular progress indicator shows lookup progress.
Results are saved to parts.json.
The CSV preview area is then replaced with categorized tables:
CAP tab: Rows containing “Capacitance”.
RES tab: Rows containing “Resistance”.
Show Circuit Name

After all three previews are ready, click “Show circuit name”.
The circuit name is generated by Google’s Generative AI based on the list of identified ICs in your BOM.
Outputs

parts.json in the project root containing a list of product attributes fetched from DigiKey.
File Type Notes

Supported input types: .xml, .csv, .yml/.yaml
Max file size enforced by the app: 25 MB
Troubleshooting

“Token error” or “Search error” messages in console:
Check internet connectivity and your DigiKey credentials.
Verify that your DigiKey account has the necessary API access.
No results in tables:
If DigiKey returns no products for a given keyword, that part is skipped.
Ensure BOM part numbers are valid vendor/manufacturer part numbers.
Google AI errors:
Ensure the API key is valid and not rate-limited.
Confirm the google-genai package is installed.
Tkinter not found:
Reinstall Python from python.org for Windows (include “tcl/tk and IDLE” during install).
Security Best Practices

Do not commit API keys or secrets to source control.
Replace hardcoded keys in gen_ai.py and digikey.py with environment variables before distributing.
License

Not specified in this repository.